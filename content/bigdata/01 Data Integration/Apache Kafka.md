---
title: Apache Kafka
tags:
  - data-integration
  - kafka
  - MQ
---
![[Pasted image 20241010000841.png]]
Kafka 传统定义：Kafka是一个`分布式`的基于`发布/订阅模式`的`消息队列`（MessageQueue），主要应用于`大数据实时处理领域`。

Kafka 最新定义： Kafka 是一个开源的`分布式事件流平台(存储+分析)`（ Event Streaming Platform），被数千家公司用于高性能`数据管道`、`流分析`、`数据集成`和`关键任务应用`。

Kafka 由`Scala`和`Java`编写,Kafka是一种`高吞吐量`的分布式`发布-订阅`消息系统.

`消息队列（mq）` : 消息的传输过程中保存消息的容器 ， 把要传输的数据放在队列中

`发布/订阅`：消息的发布者不会将消息直接发送给特定的订阅者，而是将发布的消息分为不同的类别，订阅者只接收感兴趣的消息

 默认端口 9092


Apache Kafka有4个主要的API：
    1、生产者接口
    2、消费者接口
    3、流接口
    4、连接器接口

Kafka拥有三个非常重要的角色特性：  
- 消息系统。与传统的消息队列或者消息系统类似。  
- 存储系统。可以把消息持久化到磁盘，有较好的容错性。  
- 流式处理平台。可以在流式记录产生时就进行处理。

## Kafka 的工作原理

Kafka 结合了两种消息收发模型、列队和发布-订阅，以向客户提供其各自的主要优势。通过列队可以跨多个使用器实例分发数据处理，因此具有很高的可扩展性。但是，传统队列不支持多订阅者。发布-订阅方法支持多订阅者，但是由于每条消息传送给每个订阅者，因此无法用于跨多个工作进程发布工作。Kafka uses 使用分区日志模型将这两种解决方案融合在一起。日志是一种有序的记录，这些日志分成区段或分区，分别对应不同的订阅者。这意味着，同一个主题可有多个订阅者，分别有各自的分区以获得更高的可扩展性。最后，Kafka 的模型带来可重放性，允许多个相互独立的应用程序从数据流执行读取以便按自己的速率独立地工作。


#### 消息队列的两种模式

两种类型的消息传递模式可用：

点对点模式 : 一个生产者+一个消费者+一个topic，会删除数据 `不常用` # 一对一
> 消费者主动拉取数据，消息收到后清除消息

![[Pasted image 20241010000458.png]]

发布-订阅模式 : 多个生产者+多个消费者+多个topic/相互独立，不会删除数据 # 多对多

![[Pasted image 20241010000541.png]]
## 基础架构

```python
1、生产者 # 发送数据 100T
2、broker
	2-1: 服务器 hadoop102 
	2-2: topic 主题
	2-3: 分区
	2-4: 可靠性: 副本
	2-5: leader follower
	2-6: 生产者和消费者，只针对leader节点操作
3、消费者
	3-1: 消费者和消费者相互独立
	3-2: 消费者组 : 每个分区的数据只能由消费者组中的一个消费者消费
	4-1: broker.ids 0 1 2 
	4-2: leader leader 
```


### **Kafka支持的主要应用场景**

1）“**削峰填谷**”。所谓的“削峰填谷”就是指缓冲上下游瞬时突发流量，使其更平滑
2）**解耦**，即允许独立的扩展或修改两边的处理过程，只要确保它们遵守同样的接口约束
3）**异步通信**，即允许把一个消息放入队列，但并不立即处理它们，然后再需要的时候才去处理它们。


## Refer

- [Apache Kafka](https://kafka.apache.org/)
- [1. 入门 - 【布客】kafka 中文翻译](https://kafka.apachecn.org/1/)
- [Kafka入门实战教程（1）基础概念与术语 - EdisonZhou - 博客园](https://www.cnblogs.com/edisonchou/p/kafka_study_notes_part1.html)